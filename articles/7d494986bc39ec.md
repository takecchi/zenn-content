---
title: "[NestJS] bodyã§å—ã‘å–ã£ãŸbooleanã®å€¤ãŒæ­£ã—ããƒ‘ãƒ¼ã‚¹ã•ã‚Œãªã„å•é¡Œã¨è§£æ±ºç­–"
emoji: "ğŸ›"
type: "tech"
topics:
  - "nestjs"
  - "typescript"
published: true
---

## äº‹è±¡

NestJSã§`multipart/form-data`ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã£ãŸéš›ã«ã€`boolean`ã®å€¤ãŒæ­£ã—ããƒ‘ãƒ¼ã‚¹ã•ã‚Œãªã„å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚  
å…·ä½“çš„ã«ã¯ã€`false`ã®å€¤ãŒ`true`ã¨ã—ã¦ãƒ‘ãƒ¼ã‚¹ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚(ã¨ã„ã†ã‹`true`ã«ã—ã‹ãªã‚Šã¾ã›ã‚“)

## è©²å½“ã™ã‚‹ç’°å¢ƒ

- `ValidationPipe`ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€`enableImplicitConversion: true`ã«ãªã£ã¦ã„ã‚‹
- `class-transformer`ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹(åŸ·ç­†æ™‚ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯`0.5.1`)

## çµè«–
`class-transformer`ãŒåŸå› ã§ã™ã€‚  
`multipart/form-data`ã§ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’`string`ã¨ã—ã¦å—ã‘å–ã‚‹ã®ã§ã™ãŒã€`string`->`boolean`ã®å¤‰æ›ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚

ç¾æ™‚ç‚¹(6/27)[PR](https://github.com/typestack/class-transformer/pull/1686)ãŒå‡ºã¦ã„ã¾ã™ãŒãƒãƒ¼ã‚¸ã•ã‚Œã¦ãŠã‚‰ãšã€‚

## è§£æ±ºç­–
`class-transformer`ã¯2021å¹´é ƒã‹ã‚‰ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãŒåœæ­¢ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚  
https://github.com/typestack/class-validator/issues/1775  

ãªã®ã§ä»Šå›ã¯`class-transformer`ã‚’forkã—ã¦ä¿®æ­£ã‚’è¡Œã„ã¾ã—ãŸã€‚
https://www.npmjs.com/package/@takecchi/class-transformer

## ä½¿ç”¨æ–¹æ³•

0. (ä»»æ„) `class-transformer`ã‚’ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã¾ã¾ã§ã‚‚è‰¯ã„ã§ã™ãŒã€ æ©Ÿèƒ½çš„ã«ã¯`class-transformer`ã¨åŒã˜ãªã®ã§è‡ªåˆ†ã¯ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã—ãŸã€‚  
ã‚¤ãƒ³ãƒãƒ¼ãƒˆå…ˆã‚’`class-transformer`ã‹ã‚‰`@takecchi/class-transformer`ã«å¤‰æ›´ã™ã‚‹ã ã‘ã§ã™ã€‚

```bash
npm uninstall class-transformer
```

1. `@takecchi/class-transformer`ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install @takecchi/class-transformer
```

2. `transformerPackage`ã§`@takecchi/class-transformer`ã‚’æŒ‡å®šã™ã‚‹

```ts
  app.useGlobalPipes(
    new ValidationPipe({
        transformerPackage: require('@takecchi/class-transformer'),
        transform: true,
        transformOptions: { enableImplicitConversion: true },
    }),
  );
```

## ã¾ã¨ã‚

ã“ã®çµè«–ã«è‡³ã‚‹ã¾ã§ã«å†ç¾ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œã£ãŸã‚Šã€NestJSã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚“ã ã‚Šã—ãŸã®ã§ã€  
æœ¬å½“ã¯ãã®è©±ã‚‚æ›¸ã“ã†ã¨æ€ã£ã¦ã„ãŸã®ã§ã™ãŒã€çµè«–æ›¸ã„ãŸã‚‰ä¸è¦ãªæ°—ãŒã—ãŸã®ã§å‰²æ„›ã—ã¾ã—ãŸã€‚

æ°—ã«ãªã‚‹äººå‘ã‘ã«å†ç¾ãƒªãƒã‚¸ãƒˆãƒªã ã‘ç½®ã„ã¦ãŠãã¾ã™ã€‚  
https://github.com/takecchi/nestjs-boolean-problem